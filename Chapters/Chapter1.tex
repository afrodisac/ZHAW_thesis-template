% Indicate the main file. Must go at the beginning of the file.
% !TEX root = ../main.tex

%----------------------------------------------------------------------------------------
% CHAPTER 1
%----------------------------------------------------------------------------------------
\chapter{Introduction} % Main chapter title
\label{Chapter1} % For referencing the chapter elsewhere, use \ref{Chapter1}

\subsection{Background}


Floods are one of the most common natural disasters that occur. Urban flooding is one of the key global challenges faced this century \cite{o2020drivers} as more people migrate to cities for better opportunities. Floods are often unexpected and can pose serious risks to infrastructure, economy and societies \cite{russo2023evaluation}. Climate change is also increasing the risk of flooding in certain areas and is resulting in higher rates of extreme rainfall in areas that have had no prior exposure these weather phenomena. These areas in particular, where infrastructure has not been built to accommodate these events are at much higher risk of catastrophe. In order to create useful prevention mechanisms, rapid modeling of high risk areas, preferably in real-time,  would be needed for adequate counter-measures to be put in place. \\

There are many 2D flood models that have been developed to simulate urban flooding however, most of these methods require complex mathematical equations and very powerful compute. This limits their applicability \cite{Ghimire}, especially when real-time predictions are required. For this reason, other models have been developed with the sole goal of reducing the computational power necessary for accurate, fast predictions. One of the most successful models introduced, is a Cellular Automata based approach \cite{guidolin2016weighted}. Cellular automata are simple computer programs that only utilize local information to update cell states (like water depth and velocity in this case). However, these models are still limited in terms of computational time required. Even while running on a GPU (Graphical Processing Unit), depending on the resolution and size of the data, computational time ranges from seconds to hours. \\

Machine learning models have had recent success in many applications including flood modeling \cite{russo2023evaluation, karim2023review, chaudhary2022flood}. The purpose of this thesis was to create a novel Deep learning model, by adapting a specific architecture, known as Neural Cellular Automata (NCA), proposed by \citeauthor{growing_nca} \cite{growing_nca} in order to predict water depth over a flood plain and model the spatial evolution over time. The benefits of this approach are the low parameter counts compared to other models, which results in much faster training and inference. NCA also have the benefit over other deep learning models due to their self organizing nature. Another benefit of using NCA, is the potential of the model to learn the underlying physics of the system it is trying to model.

\subsection{Related work}
Data driven approaches have been studied in the flood modeling context. Many different architectures have been used such as Convolutional Neural Networks, Graph Neural Networks, Autencoders, Deep ensembles etc. However, none have been practically applied and have not achieved widespread adoption into flood risk management, according to the author's knowledge. \\

One paper titled \citetitle{russo2023evaluation} by  \citeauthor{russo2023evaluation} \cite{russo2023evaluation}, is reviewed as this work is very similar to this thesis and provides good benchmark models for comparison. In this paper, simulated data from the CADDIES  model is used for training and testing the deep learning models. The Digital Elevation Maps (DEM) used is from two catchment areas around Switzerland, named '709' and '744' (named according to a DEM numbering system). Four models were evaluated:
\begin{enumerate}
	\item Fully Convolutional Network (FNC)
	\item AutoEncoder
	\item U-Net
	\item Graph
\end{enumerate}

Each model was trained to predict 12 time steps ahead (each time step is five minutes). They are evaluated on their unseen test set on five cells with varying water depths:
\begin{enumerate}
	\item 0-10 cm
	\item 10 - 20 cm
	\item 20 - 50 cm
	\item 50 - 100 cm
	\item > 100 cm
\end{enumerate} 

The equation used for evaluation on these five buckets is the Mean Absolute error but normalized by the standard deviation of the ground truth within each bucket.
\begin{equation}
	M_{b}(y_{i}, \hat{y_{i}}) = \frac{(y_{i} -\hat{y_{i}})}{\sigma{}_{b}}
\end{equation}
Where $M_{b}$ is the error for a bucket; $y_{i}$ is the ground truth; $\hat{y_{i}}$ is the predicted value; $\sigma $ is the standard deviation. \\

They found simpler models performed better overall but no deep learning model performed significantly better than their baselines. The models used for evaluation had some major flaws. Most of the models required previous time steps as context for the model and their water depths. In the real world, this context would not be given. The only knowledge that would be available is predicted rainfall events and DEMs. There is a lot of room for improvement and this thesis uses a slightly different architecture than the ones evaluated in the above mentioned paper. This will be discussed in more detail in Chapter \ref{Chapter4}.


\subsection{Objective}
The overall objective for this thesis is to determine the viability of NCA's in the application of Flood modeling using only a subset of features provided to the CADDIES model. The three main objectives of this thesis are as follows:

\begin{enumerate}
	\item[i)] Evaluate NCA in the application of flood modeling 
	\item[ii)] Is the model able to generalize to different rainfall events?
	\item[iii)] After explicitly training the model to predict water depth for a single time step, is emergent behavior observed in the form of a recurrent water depth prediction over multiple time steps.
\end{enumerate}